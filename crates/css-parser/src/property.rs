use std::{fmt::Display, str::FromStr};

use serde::{Deserialize, Serialize};
use strum::{Display as StrumDisplay, EnumString};

#[derive(Debug, Clone, PartialEq, Eq, Hash, Serialize, Deserialize)]
pub enum Property {
    /// The property is a custom property
    Custom(String),
    /// The property is a known property
    Known(KnownProperty),
}

impl Display for Property {
    fn fmt(&self, f: &mut std::fmt::Formatter<'_>) -> std::fmt::Result {
        match self {
            Property::Custom(name) => write!(f, "{}", name),
            Property::Known(known) => write!(f, "{}", known),
        }
    }
}

impl Property {
    pub fn is_custom(&self) -> bool {
        matches!(self, Property::Custom(_))
    }
}

impl From<String> for Property {
    fn from(value: String) -> Self {
        if value.starts_with("--") {
            Property::Custom(value)
        } else {
            match value.parse() {
                Ok(known_id) => Property::Known(known_id),
                Err(_) => Property::Custom(value),
            }
        }
    }
}

impl FromStr for Property {
    type Err = String;

    fn from_str(s: &str) -> Result<Self, Self::Err> {
        if s.starts_with("--") {
            Ok(Property::Custom(s.to_string()))
        } else {
            match s.parse() {
                Ok(known_id) => Ok(Property::Known(known_id)),
                Err(_) => Ok(Property::Custom(s.to_string())),
            }
        }
    }
}

/// A known CSS property
///
/// <https://developer.mozilla.org/en-US/docs/Web/CSS/Reference/Properties>
#[derive(
    Debug, Clone, Copy, PartialEq, Eq, Hash, StrumDisplay, EnumString, Serialize, Deserialize,
)]
#[strum(serialize_all = "kebab-case", ascii_case_insensitive)]
pub enum KnownProperty {
    AccentColor,
    AlignContent,
    AlignItems,
    AlignSelf,
    AlignmentBaseline,
    All,
    AnchorName,
    AnchorScope,
    Animation,
    AnimationComposition,
    AnimationDelay,
    AnimationDirection,
    AnimationDuration,
    AnimationFillMode,
    AnimationIterationCount,
    AnimationName,
    AnimationPlayState,
    AnimationRange,
    AnimationRangeEnd,
    AnimationRangeStart,
    AnimationTimeline,
    AnimationTimingFunction,
    Appearance,
    AspectRatio,
    BackdropFilter,
    BackfaceVisibility,
    Background,
    BackgroundAttachment,
    BackgroundBlendMode,
    BackgroundClip,
    BackgroundColor,
    BackgroundImage,
    BackgroundOrigin,
    BackgroundPosition,
    BackgroundPositionX,
    BackgroundPositionY,
    BackgroundRepeat,
    BackgroundSize,
    BaselineSource,
    BlockSize,
    Border,
    BorderBlock,
    BorderBlockColor,
    BorderBlockEnd,
    BorderBlockEndColor,
    BorderBlockEndStyle,
    BorderBlockEndWidth,
    BorderBlockStart,
    BorderBlockStartColor,
    BorderBlockStartStyle,
    BorderBlockStartWidth,
    BorderBlockStyle,
    BorderBlockWidth,
    BorderBottom,
    BorderBottomColor,
    BorderBottomLeftRadius,
    BorderBottomRightRadius,
    BorderBottomStyle,
    BorderBottomWidth,
    BorderCollapse,
    BorderColor,
    BorderEndEndRadius,
    BorderEndStartRadius,
    BorderImage,
    BorderImageOutset,
    BorderImageRepeat,
    BorderImageSlice,
    BorderImageSource,
    BorderImageWidth,
    BorderInline,
    BorderInlineColor,
    BorderInlineEnd,
    BorderInlineEndColor,
    BorderInlineEndStyle,
    BorderInlineEndWidth,
    BorderInlineStart,
    BorderInlineStartColor,
    BorderInlineStartStyle,
    BorderInlineStartWidth,
    BorderInlineStyle,
    BorderInlineWidth,
    BorderLeft,
    BorderLeftColor,
    BorderLeftStyle,
    BorderLeftWidth,
    BorderRadius,
    BorderRight,
    BorderRightColor,
    BorderRightStyle,
    BorderRightWidth,
    BorderSpacing,
    BorderStartEndRadius,
    BorderStartStartRadius,
    BorderStyle,
    BorderTop,
    BorderTopColor,
    BorderTopLeftRadius,
    BorderTopRightRadius,
    BorderTopStyle,
    BorderTopWidth,
    BorderWidth,
    Bottom,
    BoxAlign,
    BoxDecorationBreak,
    BoxDirection,
    BoxFlex,
    BoxFlexGroup,
    BoxLines,
    BoxOrdinalGroup,
    BoxOrient,
    BoxPack,
    BoxShadow,
    BoxSizing,
    BreakAfter,
    BreakBefore,
    BreakInside,
    CaptionSide,
    Caret,
    CaretAnimation,
    CaretColor,
    CaretShape,
    Clear,
    Clip,
    ClipPath,
    ClipRule,
    Color,
    ColorInterpolation,
    ColorInterpolationFilters,
    ColorScheme,
    ColumnCount,
    ColumnFill,
    ColumnGap,
    ColumnRule,
    ColumnRuleColor,
    ColumnRuleStyle,
    ColumnRuleWidth,
    ColumnSpan,
    ColumnWidth,
    Columns,
    Contain,
    ContainIntrinsicBlockSize,
    ContainIntrinsicHeight,
    ContainIntrinsicInlineSize,
    ContainIntrinsicSize,
    ContainIntrinsicWidth,
    Container,
    ContainerName,
    ContainerType,
    Content,
    ContentVisibility,
    CornerBlockEndShape,
    CornerBlockStartShape,
    CornerBottomLeftShape,
    CornerBottomRightShape,
    CornerBottomShape,
    CornerEndEndShape,
    CornerEndStartShape,
    CornerInlineEndShape,
    CornerInlineStartShape,
    CornerLeftShape,
    CornerRightShape,
    CornerShape,
    CornerStartEndShape,
    CornerStartStartShape,
    CornerTopLeftShape,
    CornerTopRightShape,
    CornerTopShape,
    CounterIncrement,
    CounterReset,
    CounterSet,
    Cursor,
    Cx,
    Cy,
    D,
    Direction,
    Display,
    DominantBaseline,
    DynamicRangeLimit,
    EmptyCells,
    FieldSizing,
    Fill,
    FillOpacity,
    FillRule,
    Filter,
    Flex,
    FlexBasis,
    FlexDirection,
    FlexFlow,
    FlexGrow,
    FlexShrink,
    FlexWrap,
    Float,
    FloodColor,
    FloodOpacity,
    Font,
    FontFamily,
    FontFeatureSettings,
    FontKerning,
    FontLanguageOverride,
    FontOpticalSizing,
    FontPalette,
    FontSize,
    FontSizeAdjust,
    FontSmooth,
    FontStretch,
    FontStyle,
    FontSynthesis,
    FontSynthesisPosition,
    FontSynthesisSmallCaps,
    FontSynthesisStyle,
    FontSynthesisWeight,
    FontVariant,
    FontVariantAlternates,
    FontVariantCaps,
    FontVariantEastAsian,
    FontVariantEmoji,
    FontVariantLigatures,
    FontVariantNumeric,
    FontVariantPosition,
    FontVariationSettings,
    FontWeight,
    ForcedColorAdjust,
    Gap,
    Grid,
    GridArea,
    GridAutoColumns,
    GridAutoFlow,
    GridAutoRows,
    GridColumn,
    GridColumnEnd,
    GridColumnStart,
    GridRow,
    GridRowEnd,
    GridRowStart,
    GridTemplate,
    GridTemplateAreas,
    GridTemplateColumns,
    GridTemplateRows,
    HangingPunctuation,
    Height,
    HyphenateCharacter,
    HyphenateLimitChars,
    Hyphens,
    ImageOrientation,
    ImageRendering,
    ImageResolution,
    InitialLetter,
    InlineSize,
    Inset,
    InsetBlock,
    InsetBlockEnd,
    InsetBlockStart,
    InsetInline,
    InsetInlineEnd,
    InsetInlineStart,
    Interactivity,
    InterestDelay,
    InterestDelayEnd,
    InterestDelayStart,
    InterpolateSize,
    Isolation,
    JustifyContent,
    JustifyItems,
    JustifySelf,
    Left,
    LetterSpacing,
    LightingColor,
    LineBreak,
    LineClamp,
    LineHeight,
    LineHeightStep,
    ListStyle,
    ListStyleImage,
    ListStylePosition,
    ListStyleType,
    Margin,
    MarginBlock,
    MarginBlockEnd,
    MarginBlockStart,
    MarginBottom,
    MarginInline,
    MarginInlineEnd,
    MarginInlineStart,
    MarginLeft,
    MarginRight,
    MarginTop,
    MarginTrim,
    Marker,
    MarkerEnd,
    MarkerMid,
    MarkerStart,
    Mask,
    MaskBorder,
    MaskBorderMode,
    MaskBorderOutset,
    MaskBorderRepeat,
    MaskBorderSlice,
    MaskBorderSource,
    MaskBorderWidth,
    MaskClip,
    MaskComposite,
    MaskImage,
    MaskMode,
    MaskOrigin,
    MaskPosition,
    MaskRepeat,
    MaskSize,
    MaskType,
    MathDepth,
    MathShift,
    MathStyle,
    MaxBlockSize,
    MaxHeight,
    MaxInlineSize,
    MaxWidth,
    MinBlockSize,
    MinHeight,
    MinInlineSize,
    MinWidth,
    MixBlendMode,
    ObjectFit,
    ObjectPosition,
    ObjectViewBox,
    Offset,
    OffsetAnchor,
    OffsetDistance,
    OffsetPath,
    OffsetPosition,
    OffsetRotate,
    Opacity,
    Order,
    Orphans,
    Outline,
    OutlineColor,
    OutlineOffset,
    OutlineStyle,
    OutlineWidth,
    Overflow,
    OverflowAnchor,
    OverflowBlock,
    OverflowClipMargin,
    OverflowInline,
    OverflowWrap,
    OverflowX,
    OverflowY,
    Overlay,
    OverscrollBehavior,
    OverscrollBehaviorBlock,
    OverscrollBehaviorInline,
    OverscrollBehaviorX,
    OverscrollBehaviorY,
    Padding,
    PaddingBlock,
    PaddingBlockEnd,
    PaddingBlockStart,
    PaddingBottom,
    PaddingInline,
    PaddingInlineEnd,
    PaddingInlineStart,
    PaddingLeft,
    PaddingRight,
    PaddingTop,
    Page,
    PageBreakAfter,
    PageBreakBefore,
    PageBreakInside,
    PaintOrder,
    Perspective,
    PerspectiveOrigin,
    PlaceContent,
    PlaceItems,
    PlaceSelf,
    PointerEvents,
    Position,
    PositionAnchor,
    PositionArea,
    PositionTry,
    PositionTryFallbacks,
    PositionTryOrder,
    PositionVisibility,
    PrintColorAdjust,
    Quotes,
    R,
    ReadingFlow,
    ReadingOrder,
    Resize,
    Right,
    Rotate,
    RowGap,
    RubyAlign,
    RubyOverhang,
    RubyPosition,
    Rx,
    Ry,
    Scale,
    ScrollBehavior,
    ScrollMargin,
    ScrollMarginBlock,
    ScrollMarginBlockEnd,
    ScrollMarginBlockStart,
    ScrollMarginBottom,
    ScrollMarginInline,
    ScrollMarginInlineEnd,
    ScrollMarginInlineStart,
    ScrollMarginLeft,
    ScrollMarginRight,
    ScrollMarginTop,
    ScrollMarkerGroup,
    ScrollPadding,
    ScrollPaddingBlock,
    ScrollPaddingBlockEnd,
    ScrollPaddingBlockStart,
    ScrollPaddingBottom,
    ScrollPaddingInline,
    ScrollPaddingInlineEnd,
    ScrollPaddingInlineStart,
    ScrollPaddingLeft,
    ScrollPaddingRight,
    ScrollPaddingTop,
    ScrollSnapAlign,
    ScrollSnapStop,
    ScrollSnapType,
    ScrollTargetGroup,
    ScrollTimeline,
    ScrollTimelineAxis,
    ScrollTimelineName,
    ScrollbarColor,
    ScrollbarGutter,
    ScrollbarWidth,
    ShapeImageThreshold,
    ShapeMargin,
    ShapeOutside,
    ShapeRendering,
    SpeakAs,
    StopColor,
    StopOpacity,
    Stroke,
    StrokeDasharray,
    StrokeDashoffset,
    StrokeLinecap,
    StrokeLinejoin,
    StrokeMiterlimit,
    StrokeOpacity,
    StrokeWidth,
    TabSize,
    TableLayout,
    TextAlign,
    TextAlignLast,
    TextAnchor,
    TextAutospace,
    TextBox,
    TextBoxEdge,
    TextBoxTrim,
    TextCombineUpright,
    TextDecoration,
    TextDecorationColor,
    TextDecorationInset,
    TextDecorationLine,
    TextDecorationSkip,
    TextDecorationSkipInk,
    TextDecorationStyle,
    TextDecorationThickness,
    TextEmphasis,
    TextEmphasisColor,
    TextEmphasisPosition,
    TextEmphasisStyle,
    TextIndent,
    TextJustify,
    TextOrientation,
    TextOverflow,
    TextRendering,
    TextShadow,
    TextSizeAdjust,
    TextSpacingTrim,
    TextTransform,
    TextUnderlineOffset,
    TextUnderlinePosition,
    TextWrap,
    TextWrapMode,
    TextWrapStyle,
    TimelineScope,
    Top,
    TouchAction,
    Transform,
    TransformBox,
    TransformOrigin,
    TransformStyle,
    Transition,
    TransitionBehavior,
    TransitionDelay,
    TransitionDuration,
    TransitionProperty,
    TransitionTimingFunction,
    Translate,
    UnicodeBidi,
    UserModify,
    UserSelect,
    VectorEffect,
    VerticalAlign,
    ViewTimeline,
    ViewTimelineAxis,
    ViewTimelineInset,
    ViewTimelineName,
    ViewTransitionClass,
    ViewTransitionName,
    Visibility,
    WhiteSpace,
    WhiteSpaceCollapse,
    Widows,
    Width,
    WillChange,
    WordBreak,
    WordSpacing,
    WritingMode,
    X,
    Y,
    ZIndex,
    Zoom,
}
